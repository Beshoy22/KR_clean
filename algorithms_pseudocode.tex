% DPLL Algorithm Variants - Pseudocode
% Compatible with Springer Nature sn-jnl document class
% Include in main document with: \input{algorithms_pseudocode.tex}

% ==================== ALGORITHM 1: BASE DPLL ====================
\begin{algorithm}[H]
\caption{Base DPLL}
\begin{algorithmic}[1]
\Function{BaseDPLL}{$clauses$, $assignment$}
    \State $clauses, assignment \gets$ \textsc{UnitPropagate}($clauses$, $assignment$)
    \If{$clauses$ contains empty clause}
        \State \Return \textsc{Unsat}
    \EndIf
    \If{$clauses = \emptyset$}
        \State \Return $\langle$\textsc{Sat}, $assignment$$\rangle$
    \EndIf

    \State $\ell \gets$ \textsc{FindPureLiteral}($clauses$)
    \If{$\ell \neq \textsc{Null}$}
        \State $clauses' \gets$ \textsc{Simplify}($clauses$, $\ell$)
        \State \Return \textsc{BaseDPLL}($clauses'$, $assignment \cup \{\ell\}$)
    \EndIf

    \State $v \gets$ \textsc{ChooseVariable}($clauses$) \Comment{DLIS heuristic}
    \State $clauses' \gets$ \textsc{Simplify}($clauses$, $v$)
    \State $result \gets$ \textsc{BaseDPLL}($clauses'$, $assignment \cup \{v\}$)
    \If{$result \neq$ \textsc{Unsat}}
        \State \Return $result$
    \EndIf

    \State $clauses'' \gets$ \textsc{Simplify}($clauses$, $\neg v$)
    \State \Return \textsc{BaseDPLL}($clauses''$, $assignment \cup \{\neg v\}$)
\EndFunction

\State

\Function{UnitPropagate}{$clauses$, $assignment$}
    \Repeat
        \For{each unit clause $c$ in $clauses$ where $|c| = 1$} \Comment{Naive: check all clauses}
            \State $\ell \gets c[0]$
            \State $assignment \gets assignment \cup \{\ell\}$
            \State $clauses \gets$ \textsc{Simplify}($clauses$, $\ell$)
        \EndFor
    \Until{no unit clauses found}
    \State \Return $\langle clauses, assignment \rangle$
\EndFunction
\end{algorithmic}
\end{algorithm}


% ==================== ALGORITHM 2: WATCHED LITERALS DPLL ====================
\begin{algorithm}[H]
\caption{Watched Literals DPLL}
\begin{algorithmic}[1]
\Function{WatchedDPLL}{$clauses$, $assignment$}
    \State \textsc{InitializeWatches}($clauses$) \Comment{Each clause watches 2 literals}
    \If{not \textsc{UnitPropagateWatched}($assignment$)}
        \State \Return \textsc{Unsat}
    \EndIf
    \If{$|assignment| = num\_vars$}
        \State \Return $\langle$\textsc{Sat}, $assignment$$\rangle$
    \EndIf

    \State $v \gets$ \textsc{ChooseVariable}($clauses$, $assignment$)
    \State $state \gets$ \textsc{SaveState}($assignment$)
    \State $assignment[v] \gets \textsc{True}$
    \If{\textsc{WatchedDPLL}($clauses$, $assignment$) $\neq$ \textsc{Unsat}}
        \State \Return $\langle$\textsc{Sat}, $assignment$$\rangle$
    \EndIf

    \State \textsc{RestoreState}($state$)
    \State $assignment[v] \gets \textsc{False}$
    \State \Return \textsc{WatchedDPLL}($clauses$, $assignment$)
\EndFunction

\State

\Function{UnitPropagateWatched}{$assignment$}
    \State $Q \gets$ initial unit clauses
    \While{$Q \neq \emptyset$}
        \State $\ell \gets Q$.\textsc{dequeue}()
        \State $assignment[|\ell|] \gets (\ell > 0)$
        \For{each clause $c$ watching $\neg\ell$} \Comment{Only check watched clauses}
            \If{\textsc{IsUnit}($c$)}
                \State $Q$.\textsc{enqueue}($c$)
            \ElsIf{\textsc{IsConflicting}($c$)}
                \State \Return \textsc{False}
            \EndIf
        \EndFor
    \EndWhile
    \State \Return \textsc{True}
\EndFunction
\end{algorithmic}
\end{algorithm}


% ==================== ALGORITHM 3: PREPROCESSING DPLL ====================
\begin{algorithm}[H]
\caption{Preprocessing DPLL}
\begin{algorithmic}[1]
\Function{PreprocessingDPLL}{$clauses$, $assignment$}
    \State \Comment{Preprocessing Phase}
    \State $clauses, assignment \gets$ \textsc{ExhaustiveUnitProp}($clauses$, $assignment$)
    \If{$clauses = \textsc{Null}$}
        \State \Return \textsc{Unsat} \Comment{Conflict during preprocessing}
    \EndIf

    \State $clauses \gets$ \textsc{PureLiteralElim}($clauses$, $assignment$)
    \State $clauses \gets$ \textsc{Subsumption}($clauses$)
    \State $clauses \gets$ \textsc{BoundedVarElim}($clauses$, $k_{max}$)

    \If{$clauses = \emptyset$}
        \State \Return $\langle$\textsc{Sat}, $assignment$$\rangle$
    \EndIf

    \State \Comment{Search Phase (uses Base DPLL)}
    \State \Return \textsc{BaseDPLL}($clauses$, $assignment$)
\EndFunction

\State

\Function{BoundedVarElim}{$clauses$, $k_{max}$}
    \For{each variable $v$ in $clauses$}
        \State $C^+ \gets$ clauses containing $v$
        \State $C^- \gets$ clauses containing $\neg v$
        \If{$|C^+| \times |C^-| \leq k_{max}$} \Comment{Limit resolution cost}
            \State $R \gets \{(c^+ \setminus \{v\}) \cup (c^- \setminus \{\neg v\}) : c^+ \in C^+, c^- \in C^-\}$
            \State $clauses \gets (clauses \setminus (C^+ \cup C^-)) \cup R$
        \EndIf
    \EndFor
    \State \Return $clauses$
\EndFunction
\end{algorithmic}
\end{algorithm}


% ==================== ALGORITHM 4: COMBINED DPLL ====================
\begin{algorithm}[H]
\caption{Combined DPLL (Preprocessing + Watched Literals)}
\begin{algorithmic}[1]
\Function{CombinedDPLL}{$clauses$, $assignment$}
    \State \Comment{Preprocessing Phase}
    \State $clauses, assignment \gets$ \textsc{ExhaustiveUnitProp}($clauses$, $assignment$)
    \State $clauses \gets$ \textsc{PureLiteralElim}($clauses$, $assignment$)
    \State $clauses \gets$ \textsc{Subsumption}($clauses$)
    \State $clauses \gets$ \textsc{BoundedVarElim}($clauses$, $k_{max}$)

    \If{$clauses = \textsc{Null}$}
        \State \Return \textsc{Unsat}
    \EndIf
    \If{$clauses = \emptyset$}
        \State \Return $\langle$\textsc{Sat}, $assignment$$\rangle$
    \EndIf

    \State \Comment{Search Phase (uses Watched Literals)}
    \State \textsc{InitializeWatches}($clauses$)
    \State \Return \textsc{WatchedSearch}($clauses$, $assignment$)
\EndFunction

\State

\Function{WatchedSearch}{$clauses$, $assignment$}
    \If{not \textsc{UnitPropagateWatched}($assignment$)}
        \State \Return \textsc{Unsat}
    \EndIf
    \If{$|assignment| = num\_vars$}
        \State \Return $\langle$\textsc{Sat}, $assignment$$\rangle$
    \EndIf

    \State $v \gets$ \textsc{ChooseVariable}($clauses$, $assignment$)
    \State $state \gets$ \textsc{SaveState}($assignment$)
    \State $assignment[v] \gets \textsc{True}$
    \If{\textsc{WatchedSearch}($clauses$, $assignment$) $\neq$ \textsc{Unsat}}
        \State \Return $\langle$\textsc{Sat}, $assignment$$\rangle$
    \EndIf

    \State \textsc{RestoreState}($state$)
    \State $assignment[v] \gets \textsc{False}$
    \State \Return \textsc{WatchedSearch}($clauses$, $assignment$)
\EndFunction
\end{algorithmic}
\end{algorithm}
