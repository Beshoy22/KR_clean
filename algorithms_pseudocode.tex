\documentclass{article}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{amsmath}
\usepackage{booktabs}

\begin{document}

\section*{DPLL Algorithm Variants - Pseudocode}

% ==================== ALGORITHM 1: BASE DPLL ====================
\begin{algorithm}[H]
\caption{Base DPLL}
\begin{algorithmic}[1]
\Function{BaseDPLL}{$clauses$, $assignment$}
    \State $clauses, assignment \gets$ \Call{UnitPropagate}{$clauses$, $assignment$}
    \If{$clauses$ contains empty clause}
        \State \Return \textsc{Unsat}
    \EndIf
    \If{$clauses = \emptyset$}
        \State \Return $\langle$\textsc{Sat}, $assignment$$\rangle$
    \EndIf

    \State $\ell \gets$ \Call{FindPureLiteral}{$clauses$}
    \If{$\ell \neq \textsc{Null}$}
        \State \Return \Call{BaseDPLL}{\Call{Simplify}{$clauses$, $\ell$}, $assignment \cup \{\ell\}$}
    \EndIf

    \State $v \gets$ \Call{ChooseVariable}{$clauses$} \Comment{DLIS heuristic}
    \State $result \gets$ \Call{BaseDPLL}{\Call{Simplify}{$clauses$, $v$}, $assignment \cup \{v\}$}
    \If{$result \neq$ \textsc{Unsat}}
        \State \Return $result$
    \EndIf

    \State \Return \Call{BaseDPLL}{\Call{Simplify}{$clauses$, $\neg v$}, $assignment \cup \{\neg v\}$}
\EndFunction

\State

\Function{UnitPropagate}{$clauses$, $assignment$}
    \Repeat
        \For{each unit clause $c$ in $clauses$ where $|c| = 1$} \Comment{Naive: check all clauses}
            \State $\ell \gets c[0]$
            \State $assignment \gets assignment \cup \{\ell\}$
            \State $clauses \gets$ \Call{Simplify}{$clauses$, $\ell$}
        \EndFor
    \Until{no unit clauses found}
    \State \Return $\langle clauses, assignment \rangle$
\EndFunction
\end{algorithmic}
\end{algorithm}


% ==================== ALGORITHM 2: WATCHED LITERALS DPLL ====================
\begin{algorithm}[H]
\caption{Watched Literals DPLL}
\begin{algorithmic}[1]
\Function{WatchedDPLL}{$clauses$, $assignment$}
    \State \Call{InitializeWatches}{$clauses$} \Comment{Each clause watches 2 literals}
    \If{not \Call{UnitPropagateWatched}{$assignment$}}
        \State \Return \textsc{Unsat}
    \EndIf
    \If{$|assignment| = num\_vars$}
        \State \Return $\langle$\textsc{Sat}, $assignment$$\rangle$
    \EndIf

    \State $v \gets$ \Call{ChooseVariable}{$clauses$, $assignment$}
    \State $state \gets$ \Call{SaveState}{$assignment$}
    \State $assignment[v] \gets \textsc{True}$
    \If{\Call{WatchedDPLL}{$clauses$, $assignment$} $\neq$ \textsc{Unsat}}
        \State \Return $\langle$\textsc{Sat}, $assignment$$\rangle$
    \EndIf

    \State \Call{RestoreState}{$state$}
    \State $assignment[v] \gets \textsc{False}$
    \State \Return \Call{WatchedDPLL}{$clauses$, $assignment$}
\EndFunction

\State

\Function{UnitPropagateWatched}{$assignment$}
    \State $Q \gets$ initial unit clauses
    \While{$Q \neq \emptyset$}
        \State $\ell \gets Q.$\Call{dequeue}{}
        \State $assignment[|\ell|] \gets (\ell > 0)$
        \For{each clause $c$ watching $\neg\ell$} \Comment{Only check watched clauses}
            \If{\Call{IsUnit}{$c$}}
                \State $Q.$\Call{enqueue}{$c$}
            \ElsIf{\Call{IsConflicting}{$c$}}
                \State \Return \textsc{False}
            \EndIf
        \EndFor
    \EndWhile
    \State \Return \textsc{True}
\EndFunction
\end{algorithmic}
\end{algorithm}


% ==================== ALGORITHM 3: PREPROCESSING DPLL ====================
\begin{algorithm}[H]
\caption{Preprocessing DPLL}
\begin{algorithmic}[1]
\Function{PreprocessingDPLL}{$clauses$, $assignment$}
    \State \Comment{Preprocessing Phase}
    \State $clauses, assignment \gets$ \Call{ExhaustiveUnitProp}{$clauses$, $assignment$}
    \If{$clauses = \textsc{Null}$}
        \State \Return \textsc{Unsat} \Comment{Conflict during preprocessing}
    \EndIf

    \State $clauses \gets$ \Call{PureLiteralElim}{$clauses$, $assignment$}
    \State $clauses \gets$ \Call{Subsumption}{$clauses$}
    \State $clauses \gets$ \Call{BoundedVarElim}{$clauses$, $k_{max}$}

    \If{$clauses = \emptyset$}
        \State \Return $\langle$\textsc{Sat}, $assignment$$\rangle$
    \EndIf

    \State \Comment{Search Phase (uses Base DPLL)}
    \State \Return \Call{BaseDPLL}{$clauses$, $assignment$}
\EndFunction

\State

\Function{BoundedVarElim}{$clauses$, $k_{max}$}
    \For{each variable $v$ in $clauses$}
        \State $C^+ \gets$ clauses containing $v$, \quad $C^- \gets$ clauses containing $\neg v$
        \If{$|C^+| \times |C^-| \leq k_{max}$} \Comment{Limit resolution cost}
            \State $R \gets \{(c^+ \setminus \{v\}) \cup (c^- \setminus \{\neg v\}) : c^+ \in C^+, c^- \in C^-\}$
            \State $clauses \gets (clauses \setminus (C^+ \cup C^-)) \cup R$
        \EndIf
    \EndFor
    \State \Return $clauses$
\EndFunction
\end{algorithmic}
\end{algorithm}


% ==================== ALGORITHM 4: COMBINED DPLL ====================
\begin{algorithm}[H]
\caption{Combined DPLL (Preprocessing + Watched Literals)}
\begin{algorithmic}[1]
\Function{CombinedDPLL}{$clauses$, $assignment$}
    \State \Comment{Preprocessing Phase}
    \State $clauses, assignment \gets$ \Call{ExhaustiveUnitProp}{$clauses$, $assignment$}
    \State $clauses \gets$ \Call{PureLiteralElim}{$clauses$, $assignment$}
    \State $clauses \gets$ \Call{Subsumption}{$clauses$}
    \State $clauses \gets$ \Call{BoundedVarElim}{$clauses$, $k_{max}$}

    \If{$clauses = \textsc{Null}$}
        \State \Return \textsc{Unsat}
    \EndIf
    \If{$clauses = \emptyset$}
        \State \Return $\langle$\textsc{Sat}, $assignment$$\rangle$
    \EndIf

    \State \Comment{Search Phase (uses Watched Literals)}
    \State \Call{InitializeWatches}{$clauses$}
    \State \Return \Call{WatchedSearch}{$clauses$, $assignment$}
\EndFunction

\State

\Function{WatchedSearch}{$clauses$, $assignment$}
    \If{not \Call{UnitPropagateWatched}{$assignment$}}
        \State \Return \textsc{Unsat}
    \EndIf
    \If{$|assignment| = num\_vars$}
        \State \Return $\langle$\textsc{Sat}, $assignment$$\rangle$
    \EndIf

    \State $v \gets$ \Call{ChooseVariable}{$clauses$, $assignment$}
    \State $polarity \gets$ \Call{CachedPhase}{$v$} \Comment{Phase saving}
    \State $state \gets$ \Call{SaveState}{$assignment$}
    \State $assignment[v] \gets polarity$
    \If{\Call{WatchedSearch}{$clauses$, $assignment$} $\neq$ \textsc{Unsat}}
        \State \Return $\langle$\textsc{Sat}, $assignment$$\rangle$
    \EndIf

    \State \Call{RestoreState}{$state$}
    \State $assignment[v] \gets \neg polarity$
    \State \Return \Call{WatchedSearch}{$clauses$, $assignment$}
\EndFunction
\end{algorithmic}
\end{algorithm}

\end{document}
